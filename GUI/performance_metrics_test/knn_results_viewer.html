<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KNN Performance Results Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .upload-section {
            padding: 40px;
            text-align: center;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .upload-box {
            border: 3px dashed #007bff;
            border-radius: 10px;
            padding: 40px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-box:hover {
            border-color: #0056b3;
            background: #f8f9ff;
        }

        .upload-box.dragover {
            border-color: #28a745;
            background: #f8fff8;
        }

        .file-input {
            display: none;
        }

        .upload-icon {
            font-size: 4em;
            color: #007bff;
            margin-bottom: 20px;
        }

        .results-container {
            display: none;
            padding: 30px;
        }

        .summary-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .metric-card h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .metric-card .value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-card .label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .section {
            margin-bottom: 40px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-content {
            padding: 25px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .metric-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }

        .metric-item .name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-item .value {
            font-size: 1.3em;
            color: #007bff;
        }

        .confusion-matrix {
            display: inline-block;
            margin: 10px;
            text-align: center;
        }

        .confusion-matrix table {
            border-collapse: collapse;
            margin: 10px auto;
        }

        .confusion-matrix td, .confusion-matrix th {
            border: 1px solid #ddd;
            padding: 10px 15px;
            text-align: center;
        }

        .confusion-matrix th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .confusion-matrix .cell-0-0 { background: #d4edda; }
        .confusion-matrix .cell-0-1 { background: #f8d7da; }
        .confusion-matrix .cell-1-0 { background: #f8d7da; }
        .confusion-matrix .cell-1-1 { background: #d4edda; }

        .performance-grade {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.9em;
        }

        .grade-excellent { background: #d4edda; color: #155724; }
        .grade-very-good { background: #d1ecf1; color: #0c5460; }
        .grade-good { background: #fff3cd; color: #856404; }
        .grade-fair { background: #f8d7da; color: #721c24; }
        .grade-poor { background: #f5c6cb; color: #721c24; }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .recommendations {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 20px;
            border-radius: 5px;
        }

        .recommendations h3 {
            color: #007bff;
            margin-bottom: 15px;
        }

        .recommendations ul {
            list-style-type: none;
        }

        .recommendations li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .recommendations li:before {
            content: "•";
            color: #007bff;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: white;
            color: #007bff;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            padding: 25px;
        }

        .tab-content.active {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .summary-section {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 KNN Performance Results</h1>
            <p>Comprehensive Analysis Dashboard for K-Nearest Neighbors Food Recommendation System</p>
        </div>

        <div class="upload-section">
            <div class="upload-box" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">📊</div>
                <h3>Upload Performance Results</h3>
                <p>Click here or drag & drop your JSON results file</p>
                <input type="file" id="fileInput" class="file-input" accept=".json" onchange="loadFile(event)">
            </div>
        </div>

        <div id="resultsContainer" class="results-container">
            <!-- Results will be loaded here -->
        </div>
    </div>

    <script>
        let performanceData = null;

        // File upload handling
        function loadFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        performanceData = JSON.parse(e.target.result);
                        displayResults(performanceData);
                    } catch (error) {
                        alert('Error reading JSON file: ' + error.message);
                    }
                };
                reader.readAsText(file);
            }
        }

        // Drag and drop functionality
        const uploadBox = document.querySelector('.upload-box');
        
        uploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadBox.classList.add('dragover');
        });
        
        uploadBox.addEventListener('dragleave', () => {
            uploadBox.classList.remove('dragover');
        });
        
        uploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadBox.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.type === 'application/json') {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            performanceData = JSON.parse(e.target.result);
                            displayResults(performanceData);
                        } catch (error) {
                            alert('Error reading JSON file: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                } else {
                    alert('Please upload a JSON file');
                }
            }
        });

        function displayResults(data) {
            const container = document.getElementById('resultsContainer');
            container.style.display = 'block';
            
            container.innerHTML = `
                ${createSummarySection(data)}
                ${createTabsSection(data)}
            `;
            
            // Initialize tabs
            initializeTabs();
            
            // Create charts
            createCharts(data);
        }

        function createSummarySection(data) {
            const summary = data.summary || {};
            const regression = data.regression_metrics?.Overall || {};
            const classification = data.classification_metrics?.Overall || {};
            
            return `
                <div class="summary-section">
                    <div class="metric-card">
                        <h3>Overall Accuracy</h3>
                        <div class="value">${(classification.Average_Accuracy * 100 || 0).toFixed(1)}%</div>
                        <div class="label">Classification Performance</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>F1 Score</h3>
                        <div class="value">${(classification.Average_F1_Score || 0).toFixed(3)}</div>
                        <div class="label">Harmonic Mean of Precision & Recall</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>R² Score</h3>
                        <div class="value">${(regression.Average_R2_Score || 0).toFixed(3)}</div>
                        <div class="label">Regression Performance</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>Dataset Size</h3>
                        <div class="value">${data.model_info?.dataset_info?.total_items || 0}</div>
                        <div class="label">Total Food Items</div>
                    </div>
                </div>
            `;
        }

        function createTabsSection(data) {
            return `
                <div class="section">
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('overview')">📊 Overview</button>
                        <button class="tab" onclick="switchTab('classification')">🎯 Classification</button>
                        <button class="tab" onclick="switchTab('regression')">📈 Regression</button>
                        <button class="tab" onclick="switchTab('recommendation')">🍽️ Recommendation</button>
                        <button class="tab" onclick="switchTab('computational')">⚡ Performance</button>
                    </div>
                    
                    <div id="overview" class="tab-content active">
                        ${createOverviewTab(data)}
                    </div>
                    
                    <div id="classification" class="tab-content">
                        ${createClassificationTab(data)}
                    </div>
                    
                    <div id="regression" class="tab-content">
                        ${createRegressionTab(data)}
                    </div>
                    
                    <div id="recommendation" class="tab-content">
                        ${createRecommendationTab(data)}
                    </div>
                    
                    <div id="computational" class="tab-content">
                        ${createComputationalTab(data)}
                    </div>
                </div>
            `;
        }

        function createOverviewTab(data) {
            const summary = data.summary || {};
            const modelInfo = data.model_info || {};
            
            return `
                <h2>🔍 Model Overview</h2>
                
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="name">Model Type</div>
                        <div class="value">${modelInfo.model_type || 'KNN'}</div>
                    </div>
                    
                    <div class="metric-item">
                        <div class="name">Evaluation Date</div>
                        <div class="value">${modelInfo.evaluation_date || 'Unknown'}</div>
                    </div>
                    
                    <div class="metric-item">
                        <div class="name">Feature Count</div>
                        <div class="value">${modelInfo.feature_count || 0}</div>
                    </div>
                    
                    <div class="metric-item">
                        <div class="name">Categories</div>
                        <div class="value">${Object.keys(modelInfo.dataset_info?.categories || {}).length}</div>
                    </div>
                </div>
                
                ${summary.Recommendations ? `
                    <div class="recommendations">
                        <h3>📋 Recommendations</h3>
                        <ul>
                            ${summary.Recommendations.map(rec => `<li>${rec}</li>`).join('')}
                        </ul>
                    </div>
                ` : ''}
                
                <div class="chart-container">
                    <canvas id="overviewChart"></canvas>
                </div>
            `;
        }

        function createClassificationTab(data) {
            const classification = data.classification_metrics || {};
            
            let content = '<h2>🎯 Classification Performance</h2>';
            
            if (classification.Overall) {
                const overall = classification.Overall;
                content += `
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="name">Average Accuracy</div>
                            <div class="value">${(overall.Average_Accuracy * 100).toFixed(1)}%</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Average Precision</div>
                            <div class="value">${overall.Average_Precision.toFixed(3)}</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Average Recall</div>
                            <div class="value">${overall.Average_Recall.toFixed(3)}</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Average F1 Score</div>
                            <div class="value">${overall.Average_F1_Score.toFixed(3)}</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Performance Grade</div>
                            <div class="value">
                                <span class="performance-grade grade-${overall.Performance_Grade.toLowerCase().replace(' ', '-')}">
                                    ${overall.Performance_Grade}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Individual condition metrics
            const conditions = ['Diabetes', 'Obesity', 'Hypertension', 'High_Cholesterol'];
            conditions.forEach(condition => {
                if (classification[condition]) {
                    const metrics = classification[condition];
                    content += `
                        <h3>📋 ${condition} Classification</h3>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="name">Accuracy</div>
                                <div class="value">${(metrics.Accuracy * 100).toFixed(1)}%</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">Precision</div>
                                <div class="value">${metrics.Precision.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">Recall</div>
                                <div class="value">${metrics.Recall.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">F1 Score</div>
                                <div class="value">${metrics.F1_Score.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">ROC AUC</div>
                                <div class="value">${metrics.ROC_AUC.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">MCC</div>
                                <div class="value">${metrics.MCC.toFixed(3)}</div>
                            </div>
                        </div>
                    `;
                }
            });
            
            // Confusion matrices
            if (data.confusion_matrices) {
                content += '<h3>🔢 Confusion Matrices</h3>';
                Object.keys(data.confusion_matrices).forEach(condition => {
                    const cm = data.confusion_matrices[condition];
                    content += createConfusionMatrix(condition, cm.matrix, cm.labels);
                });
            }
            
            content += '<div class="chart-container"><canvas id="classificationChart"></canvas></div>';
            
            return content;
        }

        function createRegressionTab(data) {
            const regression = data.regression_metrics || {};
            
            let content = '<h2>📈 Regression Performance</h2>';
            
            if (regression.Overall) {
                const overall = regression.Overall;
                content += `
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="name">Average R² Score</div>
                            <div class="value">${overall.Average_R2_Score.toFixed(3)}</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Average RMSE</div>
                            <div class="value">${overall.Average_RMSE.toFixed(3)}</div>
                        </div>
                        
                        <div class="metric-item">
                            <div class="name">Performance Grade</div>
                            <div class="value">
                                <span class="performance-grade grade-${overall.Performance_Grade.toLowerCase().replace(' ', '-')}">
                                    ${overall.Performance_Grade}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Individual condition metrics
            const conditions = ['Diabetes', 'Obesity', 'Hypertension', 'High_Cholesterol'];
            conditions.forEach(condition => {
                if (regression[condition]) {
                    const metrics = regression[condition];
                    content += `
                        <h3>📊 ${condition} Regression</h3>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="name">R² Score</div>
                                <div class="value">${metrics.R2_Score.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">MSE</div>
                                <div class="value">${metrics.MSE.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">MAE</div>
                                <div class="value">${metrics.MAE.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">RMSE</div>
                                <div class="value">${metrics.RMSE.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">MAPE</div>
                                <div class="value">${metrics.MAPE.toFixed(1)}%</div>
                            </div>
                        </div>
                    `;
                }
            });
            
            content += '<div class="chart-container"><canvas id="regressionChart"></canvas></div>';
            
            return content;
        }

        function createRecommendationTab(data) {
            const recommendation = data.recommendation_metrics || {};
            
            let content = '<h2>🍽️ Recommendation Quality</h2>';
            
            if (recommendation.KNN_Distance_Stats) {
                content += '<h3>📏 KNN Distance Statistics</h3>';
                Object.keys(recommendation.KNN_Distance_Stats).forEach(k => {
                    const stats = recommendation.KNN_Distance_Stats[k];
                    content += `
                        <h4>K = ${k.replace('k_', '')}</h4>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="name">Average Distance</div>
                                <div class="value">${stats.Average_Distance.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">Std Distance</div>
                                <div class="value">${stats.Std_Distance.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">Min Distance</div>
                                <div class="value">${stats.Min_Distance.toFixed(3)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="name">Max Distance</div>
                                <div class="value">${stats.Max_Distance.toFixed(3)}</div>
                            </div>
                        </div>
                    `;
                });
            }
            
            if (recommendation.Dataset_Coverage) {
                const coverage = recommendation.Dataset_Coverage;
                content += `
                    <h3>📊 Dataset Coverage</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="name">Total Items</div>
                            <div class="value">${coverage.Total_Items}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Categories</div>
                            <div class="value">${coverage.Unique_Categories}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Coverage Ratio</div>
                            <div class="value">${(coverage.Coverage_Ratio * 100).toFixed(2)}%</div>
                        </div>
                    </div>
                `;
            }
            
            content += '<div class="chart-container"><canvas id="recommendationChart"></canvas></div>';
            
            return content;
        }

        function createComputationalTab(data) {
            const computational = data.computational_metrics || {};
            
            let content = '<h2>⚡ Computational Performance</h2>';
            
            if (computational.Memory_Usage) {
                const memory = computational.Memory_Usage;
                content += `
                    <h3>💾 Memory Usage</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="name">Dataset Size</div>
                            <div class="value">${memory.Dataset_Size.join(' × ')}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Memory Estimate</div>
                            <div class="value">${memory.Memory_Estimate_MB.toFixed(1)} MB</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Features</div>
                            <div class="value">${memory.Feature_Count}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Samples</div>
                            <div class="value">${memory.Sample_Count}</div>
                        </div>
                    </div>
                `;
            }
            
            if (computational.Training_Times) {
                content += '<h3>⏱️ Training Times</h3><div class="metrics-grid">';
                Object.keys(computational.Training_Times).forEach(k => {
                    content += `
                        <div class="metric-item">
                            <div class="name">K = ${k.replace('k_', '')}</div>
                            <div class="value">${(computational.Training_Times[k] * 1000).toFixed(1)} ms</div>
                        </div>
                    `;
                });
                content += '</div>';
            }
            
            if (computational.Prediction_Times_Per_Query) {
                content += '<h3>🚀 Prediction Times (Per Query)</h3><div class="metrics-grid">';
                Object.keys(computational.Prediction_Times_Per_Query).forEach(k => {
                    content += `
                        <div class="metric-item">
                            <div class="name">K = ${k.replace('k_', '')}</div>
                            <div class="value">${(computational.Prediction_Times_Per_Query[k] * 1000).toFixed(2)} ms</div>
                        </div>
                    `;
                });
                content += '</div>';
            }
            
            if (computational.Scalability_Metrics) {
                const scalability = computational.Scalability_Metrics;
                content += `
                    <h3>📈 Scalability Analysis</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="name">Time Complexity</div>
                            <div class="value">${scalability.Time_Complexity}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Space Complexity</div>
                            <div class="value">${scalability.Space_Complexity}</div>
                        </div>
                        <div class="metric-item">
                            <div class="name">Suitable Dataset Size</div>
                            <div class="value">${scalability.Suitable_Dataset_Size}</div>
                        </div>
                    </div>
                `;
            }
            
            content += '<div class="chart-container"><canvas id="computationalChart"></canvas></div>';
            
            return content;
        }

        function createConfusionMatrix(condition, matrix, labels) {
            if (!matrix || matrix.length === 0) return '';
            
            return `
                <div class="confusion-matrix">
                    <h4>${condition}</h4>
                    <table>
                        <tr>
                            <th></th>
                            <th>Predicted ${labels[0]}</th>
                            <th>Predicted ${labels[1]}</th>
                        </tr>
                        <tr>
                            <th>Actual ${labels[0]}</th>
                            <td class="cell-0-0">${matrix[0][0]}</td>
                            <td class="cell-0-1">${matrix[0][1]}</td>
                        </tr>
                        <tr>
                            <th>Actual ${labels[1]}</th>
                            <td class="cell-1-0">${matrix[1][0]}</td>
                            <td class="cell-1-1">${matrix[1][1]}</td>
                        </tr>
                    </table>
                </div>
            `;
        }

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function initializeTabs() {
            // Tab functionality is handled by switchTab function
        }

        function createCharts(data) {
            // Overview Chart
            if (document.getElementById('overviewChart')) {
                createOverviewChart(data);
            }
            
            // Classification Chart
            if (document.getElementById('classificationChart')) {
                createClassificationChart(data);
            }
            
            // Regression Chart
            if (document.getElementById('regressionChart')) {
                createRegressionChart(data);
            }
            
            // Recommendation Chart
            if (document.getElementById('recommendationChart')) {
                createRecommendationChart(data);
            }
            
            // Computational Chart
            if (document.getElementById('computationalChart')) {
                createComputationalChart(data);
            }
        }

        function createOverviewChart(data) {
            const ctx = document.getElementById('overviewChart').getContext('2d');
            
            const classification = data.classification_metrics?.Overall || {};
            const regression = data.regression_metrics?.Overall || {};
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Accuracy', 'Precision', 'Recall', 'F1 Score', 'R² Score'],
                    datasets: [{
                        label: 'KNN Performance',
                        data: [
                            (classification.Average_Accuracy || 0) * 100,
                            (classification.Average_Precision || 0) * 100,
                            (classification.Average_Recall || 0) * 100,
                            (classification.Average_F1_Score || 0) * 100,
                            (regression.Average_R2_Score || 0) * 100
                        ],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(54, 162, 235, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: false
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Overall Performance Radar Chart'
                        }
                    }
                }
            });
        }

        function createClassificationChart(data) {
            const ctx = document.getElementById('classificationChart').getContext('2d');
            
            const conditions = ['Diabetes', 'Obesity', 'Hypertension', 'High_Cholesterol'];
            const metrics = ['Accuracy', 'Precision', 'Recall', 'F1_Score'];
            
            const datasets = metrics.map((metric, index) => ({
                label: metric.replace('_', ' '),
                data: conditions.map(condition => {
                    const conditionData = data.classification_metrics?.[condition];
                    return conditionData ? conditionData[metric] * 100 : 0;
                }),
                backgroundColor: `rgba(${54 + index * 50}, ${162 - index * 30}, ${235 - index * 40}, 0.5)`,
                borderColor: `rgba(${54 + index * 50}, ${162 - index * 30}, ${235 - index * 40}, 1)`,
                borderWidth: 1
            }));
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: conditions,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Performance (%)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Classification Performance by Health Condition'
                        }
                    }
                }
            });
        }

        function createRegressionChart(data) {
            const ctx = document.getElementById('regressionChart').getContext('2d');
            
            const conditions = ['Diabetes', 'Obesity', 'Hypertension', 'High_Cholesterol'];
            const r2Scores = conditions.map(condition => {
                const conditionData = data.regression_metrics?.[condition];
                return conditionData ? conditionData.R2_Score : 0;
            });
            
            const rmseScores = conditions.map(condition => {
                const conditionData = data.regression_metrics?.[condition];
                return conditionData ? conditionData.RMSE : 0;
            });
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: conditions,
                    datasets: [{
                        label: 'R² Score',
                        data: r2Scores,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        yAxisID: 'y'
                    }, {
                        label: 'RMSE',
                        data: rmseScores,
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'R² Score'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'RMSE'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Regression Performance Metrics'
                        }
                    }
                }
            });
        }

        function createRecommendationChart(data) {
            const ctx = document.getElementById('recommendationChart').getContext('2d');
            
            const knnStats = data.recommendation_metrics?.KNN_Distance_Stats || {};
            const kValues = Object.keys(knnStats).map(k => k.replace('k_', ''));
            const avgDistances = Object.values(knnStats).map(stat => stat.Average_Distance);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: kValues,
                    datasets: [{
                        label: 'Average Distance',
                        data: avgDistances,
                        borderColor: 'rgba(153, 102, 255, 1)',
                        backgroundColor: 'rgba(153, 102, 255, 0.2)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'K Value'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Average Distance'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'KNN Distance vs K Value'
                        }
                    }
                }
            });
        }

        function createComputationalChart(data) {
            const ctx = document.getElementById('computationalChart').getContext('2d');
            
            const trainingTimes = data.computational_metrics?.Training_Times || {};
            const predictionTimes = data.computational_metrics?.Prediction_Times_Per_Query || {};
            
            const kValues = Object.keys(trainingTimes).map(k => k.replace('k_', ''));
            const trainingData = Object.values(trainingTimes).map(time => time * 1000); // Convert to ms
            const predictionData = Object.values(predictionTimes).map(time => time * 1000); // Convert to ms
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: kValues,
                    datasets: [{
                        label: 'Training Time (ms)',
                        data: trainingData,
                        backgroundColor: 'rgba(255, 159, 64, 0.5)',
                        borderColor: 'rgba(255, 159, 64, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Prediction Time (ms)',
                        data: predictionData,
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'K Value'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Time (ms)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Training vs Prediction Time by K Value'
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>